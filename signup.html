<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>终焉注册 - 末日数字备案审判</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>📝</text></svg>">
</head>
<body class="terminal-flash">
    <!-- 扫描线 -->
    <div class="scanline"></div>
    
    <!-- 血色滴落效果 -->
    <div class="blood-drip" style="left: 20%; animation-delay: 1s;"></div>
    <div class="blood-drip" style="left: 60%; animation-delay: 3s;"></div>
    <div class="blood-drip" style="left: 80%; animation-delay: 5s;"></div>
    
    <div class="container distort-container">
        <header class="header">
            <h1 class="glitch-text">
                <span class="character">终</span>
                <span class="character">焉</span>
                <span class="terminal-tremble">注</span>
                <span class="terminal-tremble">册</span>
                <span class="character">审</span>
                <span class="character">判</span>
            </h1>
            <p class="subtitle flicker">填写末日信息 | 生成终焉数字墓碑</p>
        </header>

        <main class="content">
            <div class="form-container">
                <form id="icpForm">
                    <div class="form-group">
                        <label for="domain">终焉域名 *</label>
                        <input type="text" id="domain" name="domain" required 
                               placeholder="example.com (无需http://)">
                        <span class="error-text">域名将作为数字墓碑标识</span>
                    </div>

                    <div class="form-group">
                        <label for="purpose">末日用途 *</label>
                        <select id="purpose" name="purpose" required class="terminal-tremble">
                            <option value="">选择终焉用途</option>
                            <option value="个人墓碑">个人墓碑</option>
                            <option value="企业终焉">企业终焉</option>
                            <option value="电商废墟">电商废墟</option>
                            <option value="社交残骸">社交残骸</option>
                            <option value="教育遗迹">教育遗迹</option>
                            <option value="娱乐遗物">娱乐遗物</option>
                            <option value="艺术废墟">艺术废墟</option>
                            <option value="其他终焉">其他终焉</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="company">终焉实体</label>
                        <input type="text" id="company" name="company" 
                               placeholder="请输入终焉实体名称">
                    </div>

                    <div class="form-group">
                        <label for="contact">末日联系方式</label>
                        <input type="text" id="contact" name="contact" 
                               placeholder="终焉纪元可用的联系方式">
                    </div>

                    <div class="form-group">
                        <label for="description">终焉描述</label>
                        <textarea id="description" name="description" 
                                  placeholder="请描述您的末日数字墓碑..."></textarea>
                    </div>

                    <div class="form-group">
                        <button type="submit" class="btn btn-register" style="width: 100%;">
                            <span class="terminal-tremble">执 行 终 焉 备 案</span>
                        </button>
                    </div>
                </form>

                <div id="resultContainer" style="display: none;">
                    <div class="success-message">
                        <h3 class="terminal-tremble">终焉备案成功！</h3>
                        <p>您的数字墓碑已保存到终焉仓库。</p>
                    </div>

                    <div class="icp-display">
                        <h3>终焉代码片段</h3>
                        <p>将以下代码添加到您网站的末日页脚：</p>
                        <div class="code-block">
                            <code id="icpCode"></code>
                        </div>
                        <button onclick="copyCode()" class="btn btn-search" style="margin-top: 15px;">
                            <span class="terminal-tremble">复制终焉代码</span>
                        </button>
                    </div>

                    <div class="icp-display">
                        <h3>终焉详情</h3>
                        <div id="icpDetails"></div>
                    </div>
                </div>

                <div id="errorContainer" class="error-message" style="display: none;"></div>
            </div>

            <div style="text-align: center; margin-top: 30px;">
                <a href="ICP.html" class="btn btn-search">返回终焉首页</a>
                <a href="find.html" class="btn btn-search">搜索终焉记录</a>
            </div>
        </main>

        <footer class="footer">
            <p>终焉备案系统 | 末日注册页面 | © 终焉纪元 数字崩溃审判庭</p>
        </footer>
    </div>

    <!-- 终焉计数 -->
    <div class="terminal-count" id="terminalCount">0000</div>

    <script src="app.js"></script>
    <script>
        // 更新终焉计数
        function updateTerminalCount() {
            const count = Math.floor(Math.random() * 10000);
            document.getElementById('terminalCount').textContent = 
                count.toString().padStart(4, '0');
            setTimeout(updateTerminalCount, 2000 + Math.random() * 3000);
        }
        
        document.addEventListener('DOMContentLoaded', updateTerminalCount);

        document.getElementById('icpForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = {
                domain: document.getElementById('domain').value.trim(),
                purpose: document.getElementById('purpose').value,
                company: document.getElementById('company').value.trim(),
                contact: document.getElementById('contact').value.trim(),
                description: document.getElementById('description').value.trim(),
                timestamp: new Date().toISOString()
            };

            const result = await registerICP(formData);
            
            if (result.success) {
                document.getElementById('icpForm').style.display = 'none';
                document.getElementById('resultContainer').style.display = 'block';
                document.getElementById('icpCode').textContent = result.code;
                document.getElementById('icpDetails').innerHTML = result.details;
            } else {
                document.getElementById('errorContainer').style.display = 'block';
                document.getElementById('errorContainer').textContent = result.message;
            }
        });

        function copyCode() {
            const code = document.getElementById('icpCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                alert('终焉代码已复制到剪贴板！');
            });
        }
    </script>
</body>
</html>